{"version":3,"file":"spruce.umd.js","sources":["../node_modules/compare-versions/index.js","../src/utils.js","../src/observable.js","../src/index.js"],"sourcesContent":["/* global define */\n(function (root, factory) {\n  /* istanbul ignore next */\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.compareVersions = factory();\n  }\n}(this, function () {\n\n  var semver = /^v?(?:\\d+)(\\.(?:[x*]|\\d+)(\\.(?:[x*]|\\d+)(\\.(?:[x*]|\\d+))?(?:-[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?(?:\\+[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?)?)?$/i;\n\n  function indexOrEnd(str, q) {\n    return str.indexOf(q) === -1 ? str.length : str.indexOf(q);\n  }\n\n  function split(v) {\n    var c = v.replace(/^v/, '').replace(/\\+.*$/, '');\n    var patchIndex = indexOrEnd(c, '-');\n    var arr = c.substring(0, patchIndex).split('.');\n    arr.push(c.substring(patchIndex + 1));\n    return arr;\n  }\n\n  function tryParse(v) {\n    return isNaN(Number(v)) ? v : Number(v);\n  }\n\n  function validate(version) {\n    if (typeof version !== 'string') {\n      throw new TypeError('Invalid argument expected string');\n    }\n    if (!semver.test(version)) {\n      throw new Error('Invalid argument not valid semver (\\''+version+'\\' received)');\n    }\n  }\n\n  function compareVersions(v1, v2) {\n    [v1, v2].forEach(validate);\n\n    var s1 = split(v1);\n    var s2 = split(v2);\n\n    for (var i = 0; i < Math.max(s1.length - 1, s2.length - 1); i++) {\n      var n1 = parseInt(s1[i] || 0, 10);\n      var n2 = parseInt(s2[i] || 0, 10);\n\n      if (n1 > n2) return 1;\n      if (n2 > n1) return -1;\n    }\n\n    var sp1 = s1[s1.length - 1];\n    var sp2 = s2[s2.length - 1];\n\n    if (sp1 && sp2) {\n      var p1 = sp1.split('.').map(tryParse);\n      var p2 = sp2.split('.').map(tryParse);\n\n      for (i = 0; i < Math.max(p1.length, p2.length); i++) {\n        if (p1[i] === undefined || typeof p2[i] === 'string' && typeof p1[i] === 'number') return -1;\n        if (p2[i] === undefined || typeof p1[i] === 'string' && typeof p2[i] === 'number') return 1;\n\n        if (p1[i] > p2[i]) return 1;\n        if (p2[i] > p1[i]) return -1;\n      }\n    } else if (sp1 || sp2) {\n      return sp1 ? -1 : 1;\n    }\n\n    return 0;\n  };\n\n  var allowedOperators = [\n    '>',\n    '>=',\n    '=',\n    '<',\n    '<='\n  ];\n\n  var operatorResMap = {\n    '>': [1],\n    '>=': [0, 1],\n    '=': [0],\n    '<=': [-1, 0],\n    '<': [-1]\n  };\n\n  function validateOperator(op) {\n    if (typeof op !== 'string') {\n      throw new TypeError('Invalid operator type, expected string but got ' + typeof op);\n    }\n    if (allowedOperators.indexOf(op) === -1) {\n      throw new TypeError('Invalid operator, expected one of ' + allowedOperators.join('|'));\n    }\n  }\n\n  compareVersions.validate = function(version) {\n    return typeof version === 'string' && semver.test(version);\n  }\n\n  compareVersions.compare = function (v1, v2, operator) {\n    // Validate operator\n    validateOperator(operator);\n\n    // since result of compareVersions can only be -1 or 0 or 1\n    // a simple map can be used to replace switch\n    var res = compareVersions(v1, v2);\n    return operatorResMap[operator].indexOf(res) > -1;\n  }\n\n  return compareVersions;\n}));\n","import { compare } from 'compare-versions'\n\nexport const isNullOrUndefined = value => {\n    return value === null || value === undefined\n}\n\nexport const isObject = _ => {\n    return Object.getPrototypeOf(_) === Object.prototype\n}\n\nexport const isArray = _ => Array.isArray(_)\n\nexport const getMethods = obj => {\n    let methods = {}\n\n    Object.entries(obj).filter(([_, value]) => typeof value === 'function').forEach(([key, value]) => methods[key] = value)\n\n    return methods\n}\n\nexport const isTesting = () => {\n    return navigator.userAgent, navigator.userAgent.includes(\"Node.js\")\n        || navigator.userAgent.includes(\"jsdom\")\n}\n\nexport const checkForAlpine = () => {\n    if (isTesting()) {\n        return true\n    }\n\n    if (! window.Alpine) {\n        return false\n    }\n\n    return compare(window.Alpine.version, '2.7.0', '>=')\n}","import { isNullOrUndefined, isObject, isArray } from './utils'\n\nexport const createObservable = (target, callbacks) => {\n    Object.entries(target).forEach(([key, value]) => {\n        if (! isNullOrUndefined(value) && (isObject(value) || isArray(value))) {            \n            target[key] = createObservable(value, callbacks)\n        }\n    })\n\n    return new Proxy(target, {\n        get(target, key, receiver) {\n            return callbacks.get(target, key, receiver)\n        },\n        set(target, key, value, receiver) {\n            if (! isNullOrUndefined(value) && (isObject(value) || isArray(value))) {\n                value = createObservable(value, callbacks)\n            }\n\n            let originalValue = target[key]\n\n            target[key] = value\n\n            // Copy watchers from the original value if they exist\n            if (!isNullOrUndefined(originalValue) && !isNullOrUndefined(originalValue.__watchers)) {\n                target[key].__watchers = originalValue.__watchers\n            }\n\n            callbacks.set(target, key, target[key], receiver)\n\n            return true\n        }\n    })\n}","import { getMethods, checkForAlpine, isObject, isArray, isNullOrUndefined } from './utils'\nimport { createObservable } from './observable'\n\nconst Spruce = {\n    stores: {},\n\n    persistenceDriver: window.localStorage,\n\n    persisted: [],\n\n    persistedDrivers: {},\n\n    subscribers: [],\n\n    pendingWatchers: {},\n\n    disableReactivity: false,\n\n    startingCallbacks: [],\n\n    startedCallbacks: [],\n\n    hasStarted: false,\n\n    start() {\n        this.startingCallbacks.forEach(fn => fn())\n\n        this.attach()\n\n        this.stores = createObservable(this.stores, {\n            get: (target, key, receiver) => {\n                if (Object.is(receiver, this.stores) && ['get', 'set', 'toggle', 'call', 'clear'].includes(key)) {\n                    return this[key].bind(this)\n                }\n\n                return Reflect.get(target, key, receiver)\n            },\n            set: (target, key, value, receiver) => {\n                if (this.disableReactivity) {\n                    return\n                }\n\n                this.updateSubscribers()\n\n                this.runWatchers(target, key, value, receiver)\n\n                this.disableReactivity = true\n\n                try {\n                    this.persisted.forEach(this.updateLocalStorage.bind(this))\n                } catch (e) {\n                    // Do nothing here (thanks Safari!)\n                }\n\n                this.disableReactivity = false\n            }\n        })\n\n        this.hasStarted = true\n\n        this.disableReactivity = true\n\n        Object.entries(this.pendingWatchers).forEach(([name, callbacks]) => {\n            callbacks.forEach(callback => this.watch(name, callback))\n        })\n\n        this.disableReactivity = false\n\n        this.startedCallbacks.forEach(fn => fn())\n    },\n\n    starting(callback) {\n        this.startingCallbacks.push(callback)\n    },\n\n    started(callback) {\n        this.startedCallbacks.push(callback)\n    },\n\n    attach() {\n        if (! checkForAlpine()) {\n            throw new Error('[Spruce] You must be using Alpine >= 2.5.0 to use Spruce.')\n        }\n\n        const self = this\n\n        window.Alpine.addMagicProperty('store', el => {\n            self.subscribe(el)\n\n            return self.stores\n        })\n    },\n\n    store(name, state, persist = false) {\n        if (typeof state === 'function') {\n            state = state()\n        }\n\n        const isValidDriver = this.isValidDriver(persist)\n        \n        if (persist === true || isValidDriver) {\n            try {\n                this.stores[name] = this.retrieveFromLocalStorage(\n                    name,\n                    getMethods(state),\n                    isValidDriver ? persist : undefined\n                )\n\n                if (isValidDriver) {\n                    this.persistedDrivers[name] = persist\n                }\n\n                if (!this.persisted.includes(name)) {\n                    this.persisted.push(name)\n                }\n            } catch (e) {\n                // Do nothing here (thanks Safari!)\n            }\n        }\n\n        if (!this.stores[name]) {\n            this.stores[name] = state\n        }\n\n        return this.stores[name]\n    },\n\n    reset(name, state) {\n        if (this.stores[name] === undefined) {\n            return;\n        }\n        \n        this.stores[name] = state\n    },\n\n    delete(name, reload = true) {\n        if (this.stores[name] === undefined) {\n            return false;\n        }\n\n        delete this.stores[name]\n\n        if (reload) {\n            this.updateSubscribers()\n        }\n\n        return true;\n    },\n\n    deleteAll() {\n        const results = Object.keys(this.stores).map(key => this.delete(key, false))\n\n        this.updateSubscribers()\n\n        return !results.some(bool => !bool)\n    },\n\n    subscribe(el) {\n        if (!this.subscribers.includes(el)) {\n            this.subscribers.push(el)\n        }\n\n        return this.stores\n    },\n\n    updateSubscribers() {\n        this.subscribers.filter(el => !!el.__x).forEach(el => {\n            el.__x.updateElements(el)\n        })\n    },\n\n    retrieveFromLocalStorage(name, methods = {}, handler) {\n        let driver = this.persistenceDriver\n\n        if (handler !== undefined) {\n            this.guardAgainstInvalidDrivers(handler)\n\n            driver = handler\n        }\n        \n        const value = driver.getItem(`__spruce:${name}`)\n\n        if (! value) {\n            return null\n        }\n\n        let storage = JSON.parse(value)\n\n        if (typeof storage === 'object') {\n            storage = Object.assign(methods, storage)\n\n            delete storage.__watchers\n            delete storage.__key_name\n        }\n\n        return storage\n    },\n\n    updateLocalStorage(name) {\n        const store = { ...this.store(name) }\n\n        delete store.__watchers\n        delete store.__key_name\n\n        const driver = this.persistedDrivers[name] || this.persistenceDriver\n\n        driver.setItem(`__spruce:${name}`, JSON.stringify(this.store(name)))\n    },\n\n    get(name, target = this.stores) {\n        return name.split('.').reduce((target, part) => target[part], target)\n    },\n\n    set(name, value, target = this.stores) {\n        if (! isArray(name)) {\n            name = name.split('.')\n        }\n\n        if (name.length === 1) return target[name[0]] = value\n\n        if (target[name[0]]) {\n            return this.set(name.slice(1), value, target[name[0]])\n        } else {\n            target[name[0]] = {}\n\n            return this.set(name.slice(1), value, target[name[0]])\n        }\n    },\n\n    toggle(name) {\n        return this.set(name, ! this.get(name))\n    },\n\n    call(name, ...args) {\n        return this.get(name)(...args)\n    },\n\n    clear(name) {\n        return this.persistenceDriver.removeItem(`__spruce:${name}`)\n    },\n\n    watch(name, callback) {\n        if (! this.hasStarted) {\n            this.pendingWatchers[name] || (this.pendingWatchers[name] = [])\n\n            this.pendingWatchers[name].push(callback)\n\n            return [() => this.unwatch(name, callback)]\n        }\n\n        const nameParts = name.split('.')\n\n        const target = nameParts.reduce((target, part) => {\n            const sub = target[part]\n\n            if (! isNullOrUndefined(sub) && (isObject(sub) || isArray(sub))) {\n                return sub\n            }\n\n            return target\n        }, this.stores)\n\n        /**\n         * If the target object / array is the property\n         * that needs to be watched, a magic `__self` key is\n         * used so that runner can pick up on it later.\n         */\n        const part = Object.is(target, this.get(name)) ? '__self' : nameParts[nameParts.length - 1]\n\n        if (! target.hasOwnProperty('__watchers')) {\n            Object.defineProperty(target, '__watchers', {\n                enumerable: false,\n                value: new Map,\n                configurable: true\n            })\n        }\n        \n        if (! target.__watchers.has(part)) {\n            target.__watchers.set(part, new Set)\n        }\n\n        target.__watchers.get(part).add(callback)\n\n        return [() => this.unwatch(name, callback)]\n    },\n\n    unwatch(name, callback) {\n        const nameParts = name.split('.')\n\n        const target = nameParts.reduce((target, part) => {\n            const sub = target[part]\n\n            if (! isNullOrUndefined(sub) && (isObject(sub) || isArray(sub))) {\n                return sub\n            }\n\n            return target\n        }, this.stores)\n\n        const part = Object.is(target, this.get(name)) ? '__self' : nameParts[nameParts.length - 1]\n        const watchers = target.__watchers\n\n        if (! watchers.has(part)) {\n            return\n        }\n\n        watchers.get(part).delete(callback)\n    },\n\n    watchers(name) {\n        const nameParts = name.split('.')\n\n        const target = nameParts.reduce((target, part) => {\n            const sub = target[part]\n\n            if (! isNullOrUndefined(sub) && (isObject(sub) || isArray(sub))) {\n                return sub\n            }\n\n            return target\n        }, this.stores)\n\n        const part = Object.is(target, this.get(name)) ? '__self' : nameParts[nameParts.length - 1]\n\n        if (! target.__watchers) {\n            return {}\n        }\n\n        return target.__watchers.get(part)\n    },\n\n    runWatchers(target, key, value) {\n        if (! target.__watchers) {\n            return\n        }\n\n        if (target.__watchers.has(key)) {\n            target.__watchers.get(key).forEach(f => f(value))\n        }\n\n        /**\n         * The `__self` key is used for watchers that are registered\n         * to the object or array being updated.\n         */\n        if (target.__watchers.has('__self')) {\n            target.__watchers.get('__self').forEach(f => f(value, key))\n        }\n    },\n\n    persistUsing(driver) {\n        if (this.persisted.length > 0) {\n            console.warn('[Spruce] You have already initialised a persisted store. Changing the driver may cause issues.')\n        }\n\n        this.guardAgainstInvalidDrivers(driver)\n\n        this.persistenceDriver = driver\n    },\n\n    guardAgainstInvalidDrivers(driver) {\n        if (typeof driver.getItem !== 'function') {\n            throw new Error('[Spruce] The persistence driver must have a `getItem(key)` method.')\n        }\n\n        if (typeof driver.setItem !== 'function') {\n            throw new Error('[Spruce] The persistence driver must have a `setItem(key, value)` method.')\n        }\n\n        if (typeof driver.removeItem !== 'function') {\n            throw new Error('[Spruce] The persistence driver must have a `removeItem(name)` method.')\n        }\n    },\n\n    isValidDriver(driver) {\n        try {\n            this.guardAgainstInvalidDrivers(driver)\n        } catch (e) {\n            return false;\n        }\n\n        return true;\n    }\n}\n\nwindow.Spruce = Spruce\n\nconst deferrer = window.deferLoadingAlpine || function (callback) { callback() }\n\nwindow.deferLoadingAlpine = function (callback) {\n    window.Spruce.start()\n\n    deferrer(callback)\n}\n\nexport default Spruce\n"],"names":["root","factory","module","this","semver","indexOrEnd","str","q","indexOf","length","split","v","c","replace","patchIndex","arr","substring","push","tryParse","isNaN","Number","validate","version","TypeError","test","Error","compareVersions","v1","v2","forEach","s1","s2","i","Math","max","n1","parseInt","n2","sp1","sp2","p1","map","p2","undefined","allowedOperators","operatorResMap","validateOperator","op","join","compare","operator","res","isNullOrUndefined","value","isObject","_","Object","getPrototypeOf","prototype","isArray","Array","getMethods","obj","methods","entries","filter","key","isTesting","navigator","userAgent","includes","checkForAlpine","window","Alpine","createObservable","target","callbacks","Proxy","get","receiver","set","originalValue","__watchers","Spruce","stores","persistenceDriver","localStorage","persisted","persistedDrivers","subscribers","pendingWatchers","disableReactivity","startingCallbacks","startedCallbacks","hasStarted","start","fn","attach","is","bind","Reflect","updateSubscribers","runWatchers","updateLocalStorage","e","name","callback","watch","starting","started","self","addMagicProperty","el","subscribe","store","state","persist","isValidDriver","retrieveFromLocalStorage","reset","delete","reload","deleteAll","results","keys","some","bool","__x","updateElements","handler","driver","guardAgainstInvalidDrivers","getItem","storage","JSON","parse","assign","__key_name","setItem","stringify","reduce","part","slice","toggle","call","args","clear","removeItem","unwatch","nameParts","sub","hasOwnProperty","defineProperty","enumerable","Map","configurable","has","Set","add","watchers","f","persistUsing","console","warn","deferrer","deferLoadingAlpine"],"mappings":"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"}